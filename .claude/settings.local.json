{
  "permissions": {
    "allow": [
      "Bash(npm install:*)",
      "Bash(npm run dev:*)",
      "Bash(timeout:*)",
      "Bash(git pull:*)",
      "Bash(gh issue create --repo bobum/hexgame --title \"Set up OpenCode development infrastructure \\(agent.md, skills, MCPs, LSPs\\)\" --body \"$\\(cat <<''EOF''\n## Overview\n\nThis issue tracks the setup of OpenCode development infrastructure for the hexgame project, enabling AI-assisted development with proper context, tools, and workflows.\n\n---\n\n## Codebase Summary\n\n**Hexgame** is a TypeScript/Three.js hex grid strategy game with:\n- **Core Systems**: Hex coordinates, grid management, procedural map generation\n- **Game Features**: 7 unit types, A* pathfinding, turn-based gameplay\n- **Tech Stack**: Vite, TypeScript 5.9, Three.js, Vitest for testing\n- **Architecture**: Well-modularized with workers, object pooling, spatial hashing\n\n---\n\n## Recommendations for OpenCode Setup\n\n### 1. Create `agent.md` Files\n\nCreate documentation that helps AI agents understand the codebase:\n\n| File | Purpose |\n|------|---------|\n| `AGENT.md` \\(root\\) | High-level architecture, coding conventions, key decisions |\n| `src/core/AGENT.md` | Hex coordinate system, grid structure, metrics |\n| `src/generation/AGENT.md` | Map generation pipeline, noise algorithms, biome logic |\n| `src/pathfinding/AGENT.md` | A* implementation, movement costs, domain constraints |\n| `src/units/AGENT.md` | Unit types, turn system, manager patterns |\n| `src/rendering/AGENT.md` | Three.js patterns, LOD system, shader materials |\n\n### 2. Set Up MCP Servers\n\nRecommended MCPs for this project:\n\n| MCP | Purpose |\n|-----|---------|\n| **filesystem** | Read/write project files |\n| **git** | Version control operations |\n| **github** | PR management, issues, actions |\n| **fetch** | Access Three.js/game dev documentation |\n| **memory** | Persist context across sessions \\(unit stats, terrain costs, etc.\\) |\n\n### 3. Configure LSP Integration\n\nFor TypeScript support:\n- **TypeScript Language Server** \\(`typescript-language-server`\\) - Already supported via `tsconfig.json`\n- Configure OpenCode to use the project''s `node_modules/typescript` for accurate type checking\n\n### 4. Define Skills\n\nCreate skills for common workflows:\n\n| Skill | Description |\n|-------|-------------|\n| `/add-unit-type` | Scaffold new unit type \\(types, renderer, manager updates\\) |\n| `/add-terrain` | Add new terrain biome with colors, costs, generation |\n| `/add-feature` | Add map feature \\(trees, buildings, etc.\\) |\n| `/run-tests` | Execute test suite with coverage |\n| `/benchmark` | Run performance benchmarks |\n| `/generate-map` | CLI tool to generate and export maps |\n\n### 5. Create `.opencode/` Directory Structure\n\n```\n.opencode/\nâ”œâ”€â”€ config.yaml           # OpenCode configuration\nâ”œâ”€â”€ agents/\nâ”‚   â”œâ”€â”€ default.md        # General coding agent\nâ”‚   â”œâ”€â”€ game-designer.md  # Game mechanics specialist\nâ”‚   â””â”€â”€ graphics.md       # Three.js/rendering specialist\nâ”œâ”€â”€ skills/\nâ”‚   â”œâ”€â”€ add-unit-type.md\nâ”‚   â”œâ”€â”€ add-terrain.md\nâ”‚   â””â”€â”€ run-tests.md\nâ””â”€â”€ prompts/\n    â””â”€â”€ context.md        # Auto-injected project context\n```\n\n### 6. Specific Action Items\n\n- [ ] **Write root `AGENT.md`** with:\n  - Architecture diagram\n  - Key abstractions \\(HexCell, UnitData, TerrainType\\)\n  - Coding conventions \\(ES modules, no classes for data, object pooling patterns\\)\n  - Common pitfalls \\(coordinate systems, Three.js lifecycle\\)\n\n- [ ] **Document domain knowledge**:\n  - Hex coordinate math \\(cube vs offset\\)\n  - Movement cost calculations\n  - LOD level thresholds\n  - Worker communication patterns\n\n- [ ] **Set up `.vscode/settings.json`** or equivalent for:\n  - TypeScript SDK path\n  - Test runner integration\n  - Recommended extensions\n\n- [ ] **Add `mcp.json`** configuration for MCP servers\n\n- [ ] **Create skill templates** that understand the existing patterns:\n  - How units are registered in `UnitTypes.ts`\n  - How terrain is defined in `HexMetrics.ts`\n  - How tests are structured in `tests/`\n\n### 7. Priority Order\n\n1. Root `AGENT.md` \\(highest value for any AI assistance\\)\n2. MCP filesystem + git configuration\n3. TypeScript LSP setup\n4. Module-specific agent docs \\(`src/*/AGENT.md`\\)\n5. Skills for repetitive tasks\n\n---\n\n## Labels\n\n- enhancement\n- documentation\nEOF\n\\)\")",
      "Bash(git checkout:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nAdd OpenCode development infrastructure\n\n- Add root AGENT.md with architecture, conventions, and key abstractions\n- Add module-specific AGENT.md files for core, generation, pathfinding, units, rendering\n- Add .opencode/ directory with config.yaml, agents, skills, and prompts\n- Add mcp.json for MCP server configuration \\(filesystem, git, github, fetch, memory\\)\n- Add SETUP.md with MCP and LSP installation instructions\n\nCloses #39\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git push:*)",
      "Bash(gh pr create --title \"Add OpenCode development infrastructure\" --body \"$\\(cat <<''EOF''\n## Summary\n\n- Add root `AGENT.md` with architecture, conventions, and key abstractions\n- Add module-specific `AGENT.md` files for core, generation, pathfinding, units, rendering\n- Add `.opencode/` directory with config, agents, skills, and prompts\n- Add `mcp.json` for MCP server configuration\n- Add `SETUP.md` with MCP and LSP installation instructions\n\n## Files Added\n\n### AGENT.md Documentation \\(6 files\\)\n| File | Purpose |\n|------|---------|\n| `AGENT.md` | Root project guide |\n| `src/core/AGENT.md` | Hex coordinates, grid, metrics |\n| `src/generation/AGENT.md` | Map generation pipeline |\n| `src/pathfinding/AGENT.md` | A* algorithm, movement costs |\n| `src/units/AGENT.md` | Unit types, manager, turns |\n| `src/rendering/AGENT.md` | Three.js rendering, LOD |\n\n### OpenCode Configuration\n```\n.opencode/\nâ”œâ”€â”€ config.yaml           # Main config\nâ”œâ”€â”€ SETUP.md              # Installation guide\nâ”œâ”€â”€ agents/               # 3 specialized agents\nâ”œâ”€â”€ skills/               # 5 workflow skills\nâ””â”€â”€ prompts/              # Context injection\n```\n\n### MCP Configuration\n- `mcp.json` - Servers: filesystem, git, github, fetch, memory\n\n## Test plan\n\n- [ ] Verify OpenCode loads config correctly\n- [ ] Test MCP servers connect\n- [ ] Review AGENT.md accuracy against codebase\n\nCloses #39\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)\nEOF\n\\)\")",
      "Bash(ls:*)",
      "WebSearch",
      "Bash(git mv:*)",
      "Bash(git commit:*)"
    ]
  }
}
